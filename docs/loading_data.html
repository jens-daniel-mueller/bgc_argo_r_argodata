<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Pasqualina Vonlanthen &amp; Jens Daniel Müller" />


<title>Loading BGC-Argo Data</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">bgc_argo_r_argodata</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="loading_data.html">Load data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data coverage
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="coverage_timeseries.html">Time series</a>
    </li>
    <li>
      <a href="coverage_maps.html">Maps</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ph_data.html">BGC-Argo pH</a>
    </li>
    <li>
      <a href="oxygen_data.html">BGC-Argo Oxygen</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata">
    <span class="fa fa-github"></span>
     
    Code
  </a>
</li>
<li>
  <a href="https://jens-daniel-mueller.github.io/">
    <span class="fa fa-home"></span>
     
    Jens home
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Loading BGC-Argo Data</h1>
<h4 class="author">Pasqualina Vonlanthen &amp; Jens Daniel Müller</h4>
<h4 class="date">22 November, 2021</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-11-22
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>bgc_argo_r_argodata/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20211008code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20211008)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20211008code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20211008)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomjensdanielmuellerbgcargorargodatatree82f09d0de56401cff2d9f8f688f7a64f0117b612targetblank82f09d0a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/tree/82f09d0de56401cff2d9f8f688f7a64f0117b612" target="_blank">82f09d0</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomjensdanielmuellerbgcargorargodatatree82f09d0de56401cff2d9f8f688f7a64f0117b612targetblank82f09d0a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/tree/82f09d0de56401cff2d9f8f688f7a64f0117b612" target="_blank">82f09d0</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    output/

Untracked files:
    Untracked:  code/creating_dataframe.R
    Untracked:  code/creating_map.R
    Untracked:  code/pH_data_timeseries.R

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/loading_data.Rmd</code>) and HTML (<code>docs/loading_data.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/82f09d0de56401cff2d9f8f688f7a64f0117b612/analysis/loading_data.Rmd" target="_blank">82f09d0</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-22
</td>
<td>
separated Southern Ocean regions
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/77a890b07a65627f6de560fb0703ab8038cfa0e4/docs/loading_data.html" target="_blank">77a890b</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/8c2cee76570b8663e4d0814d74bd5ebb47446ade/analysis/loading_data.Rmd" target="_blank">8c2cee7</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-20
</td>
<td>
corrected offset plot
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/fb2fb748d8f6d8cfa656b98cdf2d589b4f8447f6/analysis/loading_data.Rmd" target="_blank">fb2fb74</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-19
</td>
<td>
corrected offset plot
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/578ae8c3d35ad02e6c511846ece974d1aeed570c/docs/loading_data.html" target="_blank">578ae8c</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-19
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/ae64132ed7a5ba0b3bb32e3389f403321e67aa8d/analysis/loading_data.Rmd" target="_blank">ae64132</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-19
</td>
<td>
added offset pH plot
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/ab706491022684c49392c552f038e4e76651d461/docs/loading_data.html" target="_blank">ab70649</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-19
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/171aa373a7b12a48f5ef7f8f8d6702114f9e6b9b/analysis/loading_data.Rmd" target="_blank">171aa37</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-19
</td>
<td>
updated loading pH data and color palettes
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/75399eb7487e41555eee3b319d2d92a3738af34f/docs/loading_data.html" target="_blank">75399eb</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/131582ddd8d841082b390817f65e41b4dcf85074/analysis/loading_data.Rmd" target="_blank">131582d</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-18
</td>
<td>
updated loading pH data and color palettes
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/c9a52840d9086685ba486b1fbc61cbec61b66002/docs/loading_data.html" target="_blank">c9a5284</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/0a03c5a0ebda218444205d5bdae88f6b40886306/analysis/loading_data.Rmd" target="_blank">0a03c5a</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-18
</td>
<td>
updated loading pH data and color palettes
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/c69672618637d4713394298dc0e89da1bda92a21/analysis/loading_data.Rmd" target="_blank">c696726</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-17
</td>
<td>
updated loading pH data and color palettes
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/7a01367ed6852048f198fa401eae74b91c87dd72/docs/loading_data.html" target="_blank">7a01367</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-12
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/59073c174631e4f515d1d25f24630cf390fb2ebc/analysis/loading_data.Rmd" target="_blank">59073c1</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-12
</td>
<td>
added NE Pacific oxygen
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/284003d8bc6d90b9ff68bef75628cd635eb58629/docs/loading_data.html" target="_blank">284003d</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-11
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/6276d6cafbdfd47b37205a4eee9e8321df958b9c/docs/loading_data.html" target="_blank">6276d6c</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-11
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/a103f60f51baf8db626534d2b1a721999626b84e/docs/loading_data.html" target="_blank">a103f60</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-05
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/31576f910bb4f0814eff907e3781389d100e1d40/analysis/loading_data.Rmd" target="_blank">31576f9</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-05
</td>
<td>
changed QC flag maps
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/fbd5bac3eafe5123f29fe4aa5519650a19c50c29/docs/loading_data.html" target="_blank">fbd5bac</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-04
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/5bcdcdab76f1eeff6cb4202c0ddab3589ab3149c/analysis/loading_data.Rmd" target="_blank">5bcdcda</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-11-04
</td>
<td>
added calibration description
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/68977a190e293c45ba1bea7bbeca5258a0a40440/docs/loading_data.html" target="_blank">68977a1</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-26
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/b57291acfd18141be12dc0956ab5cc08f9406ad0/docs/loading_data.html" target="_blank">b57291a</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-26
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/bba33bf519a74b13e735c1ddb5d1ea9bbb8d0c62/docs/loading_data.html" target="_blank">bba33bf</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-26
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/4bc1859e3dd407ee2ada433bf9169dd622052cbf/analysis/loading_data.Rmd" target="_blank">4bc1859</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-26
</td>
<td>
run with full data
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/aa7280d3e5330f9f7a99fb8268586e9ce68ce2c5/docs/loading_data.html" target="_blank">aa7280d</a>
</td>
<td>
jens-daniel-mueller
</td>
<td>
2021-10-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/ca7ba6b436cbc62ecc638846ed4d3a123a368c94/analysis/loading_data.Rmd" target="_blank">ca7ba6b</a>
</td>
<td>
jens-daniel-mueller
</td>
<td>
2021-10-22
</td>
<td>
adding revised code
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/d84c9048f09b88eef5b79c4182113fe4089d0eb7/docs/loading_data.html" target="_blank">d84c904</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/8ecdb433fb18a2930224a77e9cf507d4a43f13f3/docs/loading_data.html" target="_blank">8ecdb43</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/2b220998339ef7c2374575345f9566d4c99870fb/analysis/loading_data.Rmd" target="_blank">2b22099</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-22
</td>
<td>
edited text
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/c81f21cb0d38fc1b81acc0e621f1cfc5fbfbc3b5/docs/loading_data.html" target="_blank">c81f21c</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-21
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/b55928d01e5a2a737b46bfe1b148b36fd394b097/docs/loading_data.html" target="_blank">b55928d</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-21
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/58c24b6dae36f930ce1ac06aaca24d5099faf6dc/analysis/loading_data.Rmd" target="_blank">58c24b6</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-21
</td>
<td>
timeseries attempt 2, added description
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/62d85198283469ee853f0cf47ef780244958249d/docs/loading_data.html" target="_blank">62d8519</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/b8feac29ec771727a75245c8768ac90d7d1eb65a/docs/loading_data.html" target="_blank">b8feac2</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/701fffa6aca148e9b13249a8e2bf4b9f82bb5618/docs/loading_data.html" target="_blank">701fffa</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/b88a839f4f3f0fe460219f8b0ea5b00fa20d4017/analysis/loading_data.Rmd" target="_blank">b88a839</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-20
</td>
<td>
adding revised code
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/d3a081cda84a60fb87391d57d4793c7e419cc86d/docs/loading_data.html" target="_blank">d3a081c</a>
</td>
<td>
jens-daniel-mueller
</td>
<td>
2021-10-19
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/f460b9a807a27234bddb4ecc218ef967a8ad555a/analysis/loading_data.Rmd" target="_blank">f460b9a</a>
</td>
<td>
jens-daniel-mueller
</td>
<td>
2021-10-19
</td>
<td>
code review jens
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/c5e1577239684009bbbc7ba58671da87fd4a8f15/docs/loading_data.html" target="_blank">c5e1577</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/8cc01067e540c741fbd3a92508ce2c51d0ece392/analysis/loading_data.Rmd" target="_blank">8cc0106</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-18
</td>
<td>
added description in loading_data
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/305873eac985fce528f39173b1ef86b9aa9059a6/docs/loading_data.html" target="_blank">305873e</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/6b484e7a3f0e8e8a38aa919cb8ff5d8a4cb3447d/analysis/loading_data.Rmd" target="_blank">6b484e7</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-18
</td>
<td>
added description in loading_data
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/83724a0b27c7865a19e1586c52b4e3959b20f5f1/docs/loading_data.html" target="_blank">83724a0</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-14
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/4840e498ba7ee84ab1c7b9fa3d23742c84e2de48/docs/loading_data.html" target="_blank">4840e49</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-12
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/2fb35f7e08ec8188b74cff0807f01e80917dc474/analysis/loading_data.Rmd" target="_blank">2fb35f7</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-12
</td>
<td>
added reading data in page
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jens-daniel-mueller/bgc_argo_r_argodata/ff925ab19bbc9f3bc6931854ebb5412b9c390acc/docs/loading_data.html" target="_blank">ff925ab</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-11
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jens-daniel-mueller/bgc_argo_r_argodata/blob/7e0cf3450f7da0df6a83b2c34a1fe48698dde97f/analysis/loading_data.Rmd" target="_blank">7e0cf34</a>
</td>
<td>
pasqualina-vonlanthendinenna
</td>
<td>
2021-10-11
</td>
<td>
added reading data in page
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="task" class="section level1">
<h1>Task</h1>
<p>Using the argodata package to load in bgc argo data from the server and store it in a dataframe with the corresponding metadata</p>
</div>
<div id="set-cache-directory" class="section level1">
<h1>Set cache directory</h1>
<p>The cache directory stores previously downloaded files to access them more quickly. Cached files are used indefinitely by default because of the considerable time it takes to refresh them. If you use a persistent cache, you should update the index files regularly by using <code>argo_update_global()</code> (data files are also updated occasionally; update these using <code>argo_update_data()</code>)</p>
<pre class="r"><code># set cache directory
argo_set_cache_dir(cache_dir = path_argo)

# check cache directory
argo_cache_dir()</code></pre>
<pre><code>[1] &quot;/nfs/kryo/work/updata/bgc_argo_r_argodata&quot;</code></pre>
<pre class="r"><code># check argo mirror
argo_mirror()</code></pre>
<pre><code>[1] &quot;https://data-argo.ifremer.fr&quot;</code></pre>
<pre class="r"><code>argo_update_global(max_global_cache_age = Inf)  # age argument: age of the cached files to update in hours (Inf means always use the cached file, and -Inf means always download from the server) 
# ex: max_global_cache_age = 5 updates files that have been in the cache for more than 5 hours, max_global_cache_age = 0.5 updates files that have been in the cache for more than 30 minutes, etc.
argo_update_data(max_data_cache_age = Inf)</code></pre>
</div>
<div id="load-index-files" class="section level1">
<h1>Load index files</h1>
<p>Load in the synthetic (merged core and bgc) index files (uses the data stored on the ifremer server by default), keeping only delayed-mode data.</p>
<div id="file-types" class="section level3">
<h3>File Types</h3>
<p>A core-Argo profile contains the CTD sensor parameters (pressure, temperature, salinity) that are measured with the same vertical sampling scheme and at the same location and time. Additional parameters from other sensors are stored in the b-Argo profile files.</p>
<p>A b-Argo profile contains all the parameters from a float, except the core-Argo parameters temperature, pressure, and salinity. A float that performs only CTD measurements does not have a b-Argo file. The vertical level <code>PRES</code> is the simple and unambiguous link between the parameters in the core-Argo and b-Argo files. The same <code>PRES</code> is recorded in the core-Argo and b-Argo files. PRES is the only parameter duplicated in core-Argo and b-Argo profile files.</p>
<p>To facilitate the use of BGC-Argo data, the regional data centers merge each b-Argo file with its corresponding core-Argo file into one synthetic (s-Argo) file. The goal of a simplified s-Argo file is to co-locate as many BGC observations as possible while preserving the character of the sampling pattern, i.e., sample interval, number of samples, and approximate pressure locations. Data come from the single c- and b-Argo files. The synthetic pressure axis is constructed from the BGC sampling levels from each cycle. This means that there is no fixed vertical grid for all floats and all cycles.</p>
<p>The co-location takes different vertical attachments of BGC sensors into account by displacing the pressure location, which is not the case in the c- and b-files. The single-cycle s–file profiles contain all the c-file parameter observations in their original location and resolution.</p>
<p>The adjusted pressure parameter (<code>pres_adjusted</code>) is only available in the core- and s-Argo profile files. The variables <code>profile_pres_qc</code>, <code>pres_adjusted</code>, and <code>pres_adjusted_error</code>, are not duplicated in the b-Argo files.</p>
</div>
<div id="data-modes" class="section level3">
<h3>Data Modes</h3>
<p>Delayed-mode data are denoted by <code>data_mode = 'D'</code>, and are quality-checked by PIs, who apply any necessary adjustments. For the core CTD data, delayed-mode data is generally available 12 months after the transmission of raw data, because the raw data is usually of good quality. Their delayed-mode assessment involves evaluation of the long-term sensor stability, which typically requires a float record of 12 months. Incorrect QC flag attribution and erroneous raw data not flagged during real-time procedures are corrected in delayed-mode.</p>
<p>Delayed-mode BGC data may be available as early as 5-6 cycles after initial data transmission as the raw data are typically unfit for scientific usage. Adjustments significantly increase the accuracy of these data. In b- and s-Argo profile files, the variable <code>parameter_data_mode</code> indicates the mode of each parameter. Biogeochemical parameters in the same file may receive their delayed-mode adjustments at different times.</p>
<p><em>Synthetic files info: <a href="https://archimer.ifremer.fr/doc/00445/55637/80863.pdf" class="uri">https://archimer.ifremer.fr/doc/00445/55637/80863.pdf</a></em></p>
<p><em>Argo User Manual: <a href="https://archimer.ifremer.fr/doc/00187/29825/86414.pdf" class="uri">https://archimer.ifremer.fr/doc/00187/29825/86414.pdf</a></em></p>
<pre class="r"><code>bgc_index &lt;- argo_global_synthetic_prof() %&gt;%
  argo_filter_data_mode(data_mode = &#39;delayed&#39;) %&gt;%  # load in delayed-mode data
  argo_filter_date(date_min = &#39;2013-01-01&#39;,
                   date_max = Sys.time())  </code></pre>
<pre><code>Loading argo_global_synthetic_prof()</code></pre>
<pre class="r"><code># check the dates 
# max(bgc_subset$date, na.rm = TRUE)
# min(bgc_subset$date, na.rm = TRUE)

# checking alternative functions
# argo_global_meta(download = NULL, quiet = FALSE)

# argo_global_prof(download = NULL, quiet = FALSE)
# laods in core-argo files (CTD data)

# argo_global_tech(download = NULL, quiet = FALSE)
# An argo technical file contains technical information from an Argo float. This information is registered for each cycle performed by the float. 

# argo_global_traj(download = NULL, quiet = FALSE)
# argo_global_bio_traj(download = NULL, quiet = FALSE)
# load the trajectory files, which contain all received Argos and GPS locations of Argo floats. A trajectory file often contains core and BGC measurements performed at various intermediate times during the cycle and outside the vertical profiles. The full profiles collected upon ascent are not included and are stored in the profile files. 

# argo_global_bio_prof(download = NULL, quiet = FALSE)
# A B-Argo profile file contains all the parameters from a float, except the core-Argo parameters temperature, pressure, and salinity. A float that performs only CTD measurements does not have a B-Argo file

# argo_global_synthetic_prof(download = NULL, quiet = FALSE)</code></pre>
</div>
</div>
<div id="read-data" class="section level1">
<h1>Read data</h1>
<p>Read in the adjusted bgc and core variables corresponding to the index files downloaded above, with their quality control flags. (can take a while)</p>
<pre class="r"><code>bgc_data &lt;- argo_prof_levels(
  path = bgc_index,
  vars =
    c(
      &#39;PRES_ADJUSTED&#39;,
      &#39;PRES_ADJUSTED_QC&#39;,
      &#39;PRES_ADJUSTED_ERROR&#39;,
      &#39;PSAL_ADJUSTED&#39;,
      &#39;PSAL_ADJUSTED_QC&#39;,
      &#39;PSAL_ADJUSTED_ERROR&#39;,
      &#39;TEMP_ADJUSTED&#39;,
      &#39;TEMP_ADJUSTED_QC&#39;,
      &#39;TEMP_ADJUSTED_ERROR&#39;,
      &#39;DOXY_ADJUSTED&#39;,
      &#39;DOXY_ADJUSTED_QC&#39;,
      &#39;DOXY_ADJUSTED_ERROR&#39;,
      &#39;NITRATE_ADJUSTED&#39;,
      &#39;NITRATE_ADJUSTED_QC&#39;,
      &#39;NITRATE_ADJUSTED_ERROR&#39;,
      &#39;PH_IN_SITU_TOTAL_ADJUSTED&#39;,
      &#39;PH_IN_SITU_TOTAL_ADJUSTED_QC&#39;,
      &#39;PH_IN_SITU_TOTAL_ADJUSTED_ERROR&#39;
    ),
  quiet = TRUE
) 
# read in the profiles (takes a while)</code></pre>
<p>The data is read in from the cached files stored in the path specified in <code>set_argo_cache_dir()</code> (in this case, /nfs/kryo/work/updata/bgc_argo_r_argodata). To download data directly from the files stored on the ifremer server, set <code>max_global_cache_age</code> and <code>max_data_cache_age</code> to <code>-Inf</code>, which will force a new download.</p>
</div>
<div id="read-meta-data" class="section level1">
<h1>Read meta data</h1>
<p>Read in the corresponding metadata:</p>
<pre class="r"><code>bgc_metadata &lt;- argo_prof_prof(path = bgc_index)</code></pre>
<pre><code>Extracting from 138158 files</code></pre>
<pre class="r"><code># bgc_history = argo_prof_history(path = bgc_subset, quiet = TRUE)
# ?????
# returns blank output (0 observations of 0 variables)
# the same occurs if HISTORY_PARAMETER, HISTORY_ACTION, and HISTORY_QCTEST are added into the vars argument when loading the data 
# HISTORY_ACTION : Name of the action (either &#39;QCP$&#39; for QC test performed, or &#39;QCF$&#39; for QC test failed)
# HISTORY_PARAMETER : name of the parameter on which the action is performed 
# HISTORY_QCTEST : this field records the code of the QC test performed when ACTION is &#39;QCP$&#39; or the QC test failed when ACTION is &#39;QCF$&#39;

# bgc_calibration &lt;- argo_prof_calib(path = bgc_subset, quiet = TRUE)
# contains the variables: 
# PARAMETER: name of the calibrated parameter(s) 
# SCIENTIFIC_CALIB_EQUATION : calibration equation applied to the parameter (if no adjustment is necessary or the data is not adjustable, this field records &#39;none&#39;)
# SCIENTIFIC_CALIB_COEFFICIENT : calibration coefficients for this equation (if no adjustment is necessary or the data is not adjustable, this field records &#39;none&#39;)
# SCIENTIFIC_CALIB_COMMENT : comment about this calibration
# if the delayed-mode adjusted value is the same as the raw value (CTD data) the comment records &#39;no adjustment necessary&#39;; if the delayed-mode adjusted value has a QC flag of &#39;4&#39;, the comment records &#39;bad data; not adjustable&#39;. 
# SCIENTIFIC_CALIB_DATE : date when the calibration was performed</code></pre>
</div>
<div id="join-data" class="section level1">
<h1>Join data</h1>
<p>Join the metadata and data together into one dataset</p>
<pre class="r"><code>bgc_merge &lt;- full_join(bgc_data, bgc_metadata) %&gt;% 
  select(-c(profile_chla_qc:profile_cdom_qc),
        -c(profile_cndc_qc:profile_up_radiance555_qc)) %&gt;% 
    rename(lon = longitude, 
          lat = latitude) %&gt;% 
  mutate(lon = if_else(lon &lt; 20, lon + 360, lon)) %&gt;% 
  mutate(
    lat = cut(lat, seq(-90, 90, 1), seq(-89.5, 89.5, 1)), 
    lat = as.numeric(as.character(lat)),
    lon = cut(lon, seq(20, 380, 1), seq(20.5, 379.5, 1)), 
    lon = as.numeric(as.character(lon))) %&gt;% 
  mutate(depth = swDepth(pres_adjusted, latitude =  lat), 
         .before = pres_adjusted)</code></pre>
<pre><code>Joining, by = c(&quot;file&quot;, &quot;n_prof&quot;)</code></pre>
<pre class="r"><code># bgc_merge_test &lt;- full_join(bgc_data, bgc_calibration) (not sure why but it crashes R every time)</code></pre>
</div>
<div id="write-data" class="section level1">
<h1>Write data</h1>
<div id="full-data" class="section level3">
<h3>Full data</h3>
<pre class="r"><code>path_argo_preprocessed &lt;- paste0(path_argo, &quot;/preprocessed_bgc_data&quot;)

bgc_index %&gt;%
  write_rds(file = paste0(path_argo_preprocessed, &quot;/bgc_index.rds&quot;))

# bgc_calibration %&gt;%
#  write_rds(file = paste0(path_argo_preprocessed, &quot;/bgc_calibration.rds&quot;))

bgc_data %&gt;%
  write_rds(file = paste0(path_argo_preprocessed, &quot;/bgc_data.rds&quot;))

bgc_merge %&gt;%
  write_rds(file = paste0(path_argo_preprocessed, &quot;/bgc_merge.rds&quot;))</code></pre>
</div>
<div id="ph-data" class="section level3">
<h3>pH data</h3>
<pre class="r"><code># create a dataframe of full pH data (only good data) with corresponding CTD and metadata, in a 1x1º longitude/latitude grid 
ph_merge_1x1 &lt;- bgc_merge %&gt;% 
  select(-c(doxy_adjusted:nitrate_adjusted_error),
         -c(profile_doxy_qc, profile_nitrate_qc)) %&gt;% 
  filter(ph_in_situ_total_adjusted_qc == &#39;1&#39;) %&gt;% 
  mutate(year = year(date),
         month = month(date),
         .after = n_prof)


# create a dataframe of pH data in the surface ocean (upper 20 m of the watercolumn), in a 1x1º longitude/latitude grid
ph_surface_1x1 &lt;- ph_merge_1x1 %&gt;% 
  filter(between(depth, 0, 20)) 

# create a dataframe of pH for the surface ocean (upper 20 m of the watercolumn) in a 2x2º longitude/latitude grid 
ph_surface_2x2 &lt;- ph_surface_1x1 %&gt;%
  mutate(
    lat = cut(lat, seq(-90, 90, 2), seq(-89, 89, 2)), 
    lat = as.numeric(as.character(lat)),
    lon = cut(lon, seq(20, 380, 2), seq(21, 379, 2)), 
    lon = as.numeric(as.character(lon))
   )   # regrid into 2x2º grid </code></pre>
<pre class="r"><code>bgc_metadata &lt;- bgc_metadata %&gt;%
  rename(lon = longitude,
         lat = latitude) %&gt;%
  mutate(lon = if_else(lon &lt; 20, lon + 360, lon)) %&gt;%
  mutate(
    lat = cut(lat, seq(-90, 90, 1), seq(-89.5, 89.5, 1)),
    lat = as.numeric(as.character(lat)),
    lon = cut(lon, seq(20, 380, 1), seq(20.5, 379.5, 1)),
    lon = as.numeric(as.character(lon))
  ) %&gt;% 
  select(
    -c(profile_chla_qc:profile_cdom_qc),
    -c(profile_cndc_qc:profile_up_radiance555_qc)
  )</code></pre>
<pre class="r"><code>ph_merge_1x1 %&gt;% 
  write_rds(file = paste0(path_argo_preprocessed, &quot;/ph_merge_1x1.rds&quot;))

ph_surface_1x1 %&gt;% 
  write_rds(file = paste0(path_argo_preprocessed, &quot;/ph_surface_1x1.rds&quot;))

ph_surface_2x2 %&gt;% 
  write_rds(file = paste0(path_argo_preprocessed, &quot;/ph_surface_2x2.rds&quot;))

bgc_metadata %&gt;%
  write_rds(file = paste0(path_argo_preprocessed, &quot;/bgc_metadata.rds&quot;))</code></pre>
</div>
</div>
<div id="data-set-description" class="section level1">
<h1>Data set description</h1>
<div id="columns" class="section level2">
<h2>Columns</h2>
<p>The resulting dataframe contains:</p>
<ul>
<li><p>the file name (<code>file</code> column)</p></li>
<li><p>the sampling level (<code>n_level</code> column)</p></li>
<li><p>the number of profiles per file (<code>n_prof</code> column; Each single-cycle synthetic profile has the dimension <code>n_prof = 1</code>).</p></li>
<li><p>adjusted values for pressure (<code>PRES</code>, in dbar), salinity (<code>PSAL</code>, in psu), temperature (<code>TEMP</code>, in degrees C), dissolved oxygen (<code>DOXY</code>, in µmol kg<sup>-1</sup>), pH (<code>PH_IN_SITU_TOTAL</code>), and nitrate (<code>NITRATE</code>, in µmol kg<sup>-1</sup>) (<code>parameter_adjusted</code> columns). This column is mandatory, so if no adjustment was performed (i.e. <code>parameter_adjusted</code> does not exist), FillValue is inserted (e.g., <code>temp_adjusted:FillValue = 99999.f</code>). If the raw value did not require adjustment in delayed-mode, then <code>parameter_adjusted</code> = <code>parameter</code>.</p></li>
<li><p>a quality control flag associated with these adjusted values (<code>parameter_adjusted_qc</code> columns). If an adjusted value does not exist (e.g., <code>temp_adjusted = 99999.f</code>), then FillValue is inserted (e.g., <code>temp_adjusted_qc = " "</code>).</p></li>
<li><p>an error estimate on the adjustment of the measurement (<code>parameter_adjusted_error</code> columns). If no adjusted value exists (e.g., <code>temp_adjusted = 99999.f</code>), then FillValue is inserted (e.g., <code>temp_adjusted_error = 99999.f</code>)</p></li>
<li><p>WMO float identifier (<code>platform_number</code> column)</p></li>
<li><p>name of the project in charge of the float (<code>project_name</code> column)</p></li>
<li><p>name of principal investigator in charge of the float (<code>pi_name</code> column)</p></li>
<li><p>float cycle number (<code>cycle_number</code> column; <em>cycle 0 is the launch cycle during which technical data or configuration information is transmitted; cycle 1 is the first complete cycle</em>)</p></li>
<li><p>descending (D) or ascending (A) profile (<code>direction</code> column). <em>Profile measurements are taken on ascent, occasionally during descent (rarely both).</em></p></li>
<li><p>code for the data centre in charge of the float data management (<code>data_centre</code> column)</p></li>
<li><p>the type of float (<code>platform_type</code> column)</p></li>
<li><p>firmware version of the float (<code>firmware_version</code> column)</p></li>
<li><p>instrument type from the WMO code table 1770 (<code>wmo_inst_type</code> column)</p></li>
<li><p>the date and time at which the measurement was taken, in UTC (<code>date</code> column)</p></li>
<li><p>a quality control flag for the date and time value (<code>date_qc</code> column)</p></li>
<li><p>the date and time of the profile location (<code>date_location</code> column)</p></li>
<li><p>latitude in degrees N (<code>latitude</code> column)</p></li>
<li><p>longitude in degrees E (<code>longitude</code> column)</p></li>
<li><p>quality control flag on the position (<code>position_qc</code> column)</p></li>
<li><p>name of the system in charge of positioning the float locations (<code>positioning_system</code> column)</p></li>
<li><p>unique number of the mission to which this float belongs (<code>config_mission_number</code> column,</p></li>
<li><p>a global quality control flag on the profile of the parameter (<code>profile_parameter_qc</code> column; FillValue = " ")</p></li>
</ul>
</div>
<div id="qc-flags" class="section level2">
<h2>QC flags</h2>
<p>QC flags for values (‘<code>parameter_adjusted_qc</code>’ columns) are between 1 and 8, where:<br />
1 is ‘good’ data,<br />
2 is ‘probably good’ data,<br />
3 is ‘probably bad’ data,<br />
4 is ‘bad’ data,<br />
5 is ‘value changed’,<br />
8 is ‘estimated value’,<br />
9 is ‘missing value’ (data parameter will record FillValue)<br />
(6 and 7 are not used).</p>
<p>Profile QC flags (‘<code>profile_parameter_qc</code>’ columns) are QC codes attributed to the entire profile, and indicate the number of depth levels (in %) where the value is considered to be good data (QC flags of 1, 2, 5, and 8; QC flags of 9 or " " are not used in the computation):<br />
‘A’ means 100% of profile levels contain good data,<br />
‘B’ means 75-&lt;100% of profile levels contain good data,<br />
‘C’ means 50-75% of profile levels contain good data,<br />
‘D’ means 25-50% of profile levels contain good data,<br />
‘E’ means &gt;0-50% of profile levels contain good data,<br />
‘F’ means 0% of profile levels contain good data.</p>
<div id="quality-control-tests" class="section level3">
<h3>Quality Control Tests</h3>
<p>There are two levels of Argo data quality control:</p>
<ul>
<li>The first level is the real-time system that performs a set of agreed automatic checks</li>
<li>The second level is the delayed-mode quality control system.</li>
</ul>
<div id="real-time-qc-tests" class="section level4">
<h4>Real-time QC tests</h4>
<ol style="list-style-type: decimal">
<li><strong>Platform identification test</strong></li>
</ol>
<p>If a float WMO ID cannot be matched to the correct float platform then none of the data will be distributed.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Impossible date test</strong></li>
</ol>
<p>This test requires that the Julian Day of the float be later than 1st January 1997 and earlier than the current date of the check (in UTC time). If the date of a profile fails this test, the date of the profile should be flagged as bad data (‘4’) and none of the profile data is distributed.</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Impossible location test</strong></li>
</ol>
<p>This test requires that the observation latitude and longitude of a float be sensible, with latitude in the range -90 to 90º, and longitude in the range -180 to 180º.</p>
<p>If either latitude or longitude fails this test, the position is flagged as bad data (‘4’) and none of the profile data is distributed.</p>
<ol start="4" style="list-style-type: decimal">
<li><strong>Position on land test</strong></li>
</ol>
<p>This test requires that the observation latitude and longitude be located in an ocean. If a position cannot be located in an ocean, the position is flagged as bad data (‘4’) and none of the profile data is distributed.</p>
<ol start="5" style="list-style-type: decimal">
<li><strong>Impossible speed test</strong></li>
</ol>
<p>Drift speeds for floats can be generated given the positions and times of the floats when they are at the sea surface and between profiles. In all cases, we would not expect the drift speed to exceed 3 ms<sup>-1</sup>. If it does, it means either the positions or times are bad data, or a float is mislabeled. Using the multiple positions and times that are normally available for a float while at the sea surface, it is often possible to isolate the one position or time that is an error.</p>
<p>If an acceptable position and time can be used from the available suite, then the data can be distributed. Otherwise, the position, the time, or both, are flagged as bad data (‘4’) and the profile data is not distributed.</p>
<ol start="6" style="list-style-type: decimal">
<li><strong>Global range test</strong></li>
</ol>
<p>This test applies a gross filter on the values of <code>TEMP</code>, <code>PRES</code>, and <code>PSAL</code>. The ranges need to accommodate all of the expected extremes in the ocean.</p>
<ul>
<li>Pressure cannot be less than -5 dbar. If <code>PRES</code> &lt; -5, then <code>PRES_QC</code> = ‘4’, <code>TEMP_QC</code> = ‘4’, and <code>PSAL_QC</code> = ‘4’.</li>
<li>Pressure in the range -5 to -2.4 dbar should be considered ‘probably bad’ data. If -5 ≤ <code>PRES</code> ≤ -2.4, then <code>PRES_QC</code> = ‘3’, <code>TEMP_QC</code> = ‘3’, <code>PSAL_QC</code> = ‘3’.</li>
<li>Temperature should be in the range -2.5 to 40.0 ºC. Outside of this range <code>TEMP_QC</code> = ‘4’.</li>
<li>Salinity should be in the range 2 to 41.0 PSU. Outside of this range, <code>PSAL_QC</code> = ‘4’.</li>
<li><code>DOXY</code> should be in the range -5 to 600 µmol kg<sup>-1</sup>. Outside of this range, <code>DOXY_QC = '4'</code>.</li>
<li><code>PH_IN_SITU_TOTAL</code> should be in the range 7.3 to 8.5. Outside of this range, <code>PH_IN_SITU_TOTAL_QC = '4'</code>.</li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li><strong>Regional range test</strong> (CTD data)</li>
</ol>
<p>This test applies to certain regions of the world where conditions can be further qualified. In this case, specific ranges for observations from the Mediterranean Sea and the Red Sea further restrict what can be accepted as reasonable values.</p>
<p>If a value fails this test, it is flagged as bad data (‘4’) and removed from the initial distribution. If temperature and salinity at the same pressure level both fail this test, both values are flagged as bad data (‘4’) and values for pressure, temperature, and salinity are removed from the distribution.</p>
<ol start="8" style="list-style-type: decimal">
<li><strong>Pressure increasing test</strong> (CTD data)</li>
</ol>
<p>This test requires that the vertical profile has pressures that are monotonically increasing (assuming the pressure levels are ordered from smallest to largest).</p>
<p>If there is a region of constant pressure, all but the first of the consecutive constant pressure levels is flagged as bad data (‘4’). If there is a region where pressure reverses, all of the pressures in the reversed part of the profile are flagged as bad data (‘4’). All pressures flagged as bad data and associated temperatures and salinities are removed.</p>
<ol start="9" style="list-style-type: decimal">
<li><strong>Spike test</strong></li>
</ol>
<p>The difference between sequential measurements, where one measurement is significantly different from adjacent ones, is a spike in both size and gradient. This test does not consider differences in pressure, but assumes a sampling that adequately reproduces changes in temperature and salinity with pressure.</p>
<p>Test value = | V2 - (V3 + V1)/2 | - | (V3 - V1)/2 |</p>
<p>where V2 is the measurement being tested, and V1 and V3 are the values above and below.</p>
<p>Temperature: the V2 value is flagged when:</p>
<ul>
<li>the test value exceeds 6.0 ºC for pressures less than 500 dbar, or</li>
<li>the test value exceeds 2.0 ºC for pressures equal to or greater than 500 dbar.</li>
</ul>
<p>Salinity: the V2 value is flagged when:</p>
<ul>
<li>the test value exceeds 0.9 PSU for pressures less than 500 dbar, or</li>
<li>the test value exceeds 0.3 PSU for pressures equal to or greater than 500 dbar.</li>
</ul>
<p>DOXY: the V2 value is flagged when:</p>
<ul>
<li>the test value exceeds 50 µmol kg<sup>-1</sup> for pressures less than 500 dbar, or</li>
<li>the test value exceeds 25 µmol kg<sup>-1</sup> for pressures equal to or greater than 500 dbar.</li>
</ul>
<p>For pH:</p>
<p>Test value 2 = | V2 - median(V0, V1, V2, V3, V4) |</p>
<p>where the test value represents the anomaly of the observed pH from the median of the surrounding data. A pH data point is considered a spike and flagged as bad (‘4’) if Test Value 2 &gt; 0.04pH</p>
<p>If the value V2 fails this test, it is flagged as bad data (‘4’) and is removed. If temperature and salinity both fail this test, both values are flagged as bad data (‘4’) and values for temperature, salinity and pressure are removed.</p>
<ol start="10" style="list-style-type: decimal">
<li>Obsolete</li>
<li><strong>Gradient test</strong> (DOXY only)</li>
</ol>
<p>This test is failed when the difference between vertically adjacent measurements is too steep. The test does not consider changes in depth, but assumes a sampling that adequately reproduces changes in DOXY with depth</p>
<p>Test value = | V2 - (V3 + V1)/2 |</p>
<p>where V2 is the value being tested as a spike, and V1 and V3 are the values above and below.</p>
<p>For DOXY, V2 is flagged when:</p>
<ul>
<li><p>the test value exceeds 50 µmol kg<sup>-1</sup> for pressures less than 500 dbar, or</p></li>
<li><p>the test value exceeds 25 µmol kg<sup>-1</sup> for pressures equal to or greater than 500 dbar</p></li>
</ul>
<ol start="12" style="list-style-type: decimal">
<li><strong>Digit rollover test</strong> (CTD data)</li>
</ol>
<p>Only so many bits are allowed to store temperature and salinity values in a profiling float. This range is not always large enough to accommodate conditions which are encountered in the ocean. When the range is exceeded, stored values rollover to the lower end of the range. This rollover should be detected and compensated for when profiles are constructed from the data stream of the float. This test is used to make sure the rollover is properly detected.</p>
<ul>
<li>Temperature difference between adjacent pressures &gt; 10 ºC</li>
<li>Salinity difference between adjacent pressures &gt; 5 PSU</li>
</ul>
<p>If a value fails this test, it is flagged as bad data (‘4’) and removed from the initial distribution. If temperature and salinity at the same pressure level both fail this test, both values are flagged as bad data (‘4’) and values for pressure, temperature, and salinity are removed from the distribution.</p>
<ol start="13" style="list-style-type: decimal">
<li><strong>Stuck value test</strong></li>
</ol>
<p>This test looks for CTD and BGC measurements in the same profile being identical.</p>
<p>If this occurs, all of the values affected parameter are flagged as bad data (‘4’) and removed from the distribution. If both temperature and salinity are affected, then all observed values from the profile are flagged as bad data (‘4’).</p>
<ol start="14" style="list-style-type: decimal">
<li><strong>Density inversion test</strong> (CTD data)</li>
</ol>
<p>This test compares potential density between valid measurements in a profile in both directions (i.e., from top to bottom, and from bottom to top). Values of temperature and salinity at the same pressure level P<sub>i</sub> are used to compute potential density ρ<sub>i</sub> ( or σ<sub>i</sub> = ρ<sub>i</sub> - 1000) kg m<sup>-3</sup>, referenced to the mid-point between Pi and the next valid pressure level. A threshold of 0.03 kg m<sup>-3</sup> is allowed for small density inversions.</p>
<p>From top to bottom, if the potential density calculated at the greater pressure P<sub>i+1</sub> is less than that calculated at the lesser pressure P<sub>i</sub> by more than 0.03 kg m<sub>-3</sub>, both the temperature and salinity values at pressure P<sub>i</sub> are flagged as bad data (‘4’). From bottom to top, if the potential density calculated at the lesser pressure P<sub>i-1</sub> is greater than that calculated at the greater pressure P<sub>i</sub> by more than 0.03 kg m<sub>-3</sub>, both the temperature and salinity values at pressure P<sub>i</sub> are flagged as bad data (‘4’). Bad temperature and salinity are removed from the distribution.</p>
<ol start="15" style="list-style-type: decimal">
<li><strong>Grey list test</strong></li>
</ol>
<p>This test is implemented as a mechanism for data assembly centers (DACs) to flag, in real-time, sensors that are potentially not working correctly. Each DAC manages a grey list and sends it to the GDACs. The merged grey list from all DACs is available from the GDACs.</p>
<p>Naming convention: <code>xxx_greylist.csv</code> (where <code>xxx</code> is the DAC name, e.g., <code>aoml_greylist.csv</code>, <code>coriolis_greylist.csv</code>, etc).</p>
<p>Columns: <code>PLATFORM</code>, <code>PARAMETER</code>, <code>START_DATE</code>, <code>END_DATE</code>, <code>QC</code>, <code>COMMENT</code>, <code>DAC</code></p>
<p>The decision to insert a float parameter in the grey list comes from the PI or the delayed-mode operator. A float parameter should be put in the grey list when the sensor drift is too big to be adjusted in real-time, or when the sensor is judged to be potentially not working correctly.</p>
<p>The grey list concerns only real-time files. When an anomalous float is dead and the offending parameter has been adjusted in delayed-mode, it is removed from the grey list. When an anomalous float is active and the offending parameter has been partially adjusted in delayed-mode, it will remain on the grey list if real-time adjustment is not adequate.</p>
<p>Grey-listed parameters are flagged as probably good (‘2’), probably bad (‘3’) or bad (‘4’) data, as determined by the PI or the delayed-mode operator.</p>
<ol start="16" style="list-style-type: decimal">
<li><strong>Gross salinity or temperature sensor drift test</strong> (CTD)</li>
</ol>
<p>This test is implemented to detect a sudden and significant sensor drift. It calculates the average temperature and salinity from the deepest 100 dbar of a profile and the previous good profile. Only measurements with good QC are used.</p>
<p>For salinity, if the difference between the two average values is more than 0.5 PSU, then all the salinity values of the profile are flagged as probably bad data (‘3’). For temperature, if the difference between the two average values is more than 1 ºC, then all the temperature values from the profile are flagged as probably bad data (‘3’).</p>
<ol start="17" style="list-style-type: decimal">
<li><strong>Visual QC test</strong></li>
</ol>
<p>This is subjective visual inspection of float measurements by an operator. This test is not mandatory before real-time data distribution.</p>
<ol start="18" style="list-style-type: decimal">
<li><strong>Frozen profile test</strong> (CTD data)</li>
</ol>
<p>This test is used to detect a float that produces the same profile (with very small deviations) over and over again. Typically the differences between two profiles are of the order of 0.001 PSU for salinity and of the order 0.01 ºC for temperature.</p>
<ol style="list-style-type: upper-alpha">
<li><p>Derive temperature and salinity profiles by averaging the original profiles to get mean values for each profile in 50 dbar slabs (T_prof, T_previous_prof, S_prof, S_previous_prof). This is necessary because the floats do not sample at the same level in each profile.</p></li>
<li><p>Obtain absolute values of the difference between the averaged temperature and salinity profiles as follows:</p></li>
</ol>
<ul>
<li>deltaT = abs(T_prof - T_previous_prof)</li>
<li>deltaS = abs(S_prof - S_previous_prof)</li>
</ul>
<ol start="3" style="list-style-type: upper-alpha">
<li>Find the maximum, minimum, and mean of the absolute values of the averaged differences between profiles for temperature and salinity:</li>
</ol>
<ul>
<li>mean(deltaT), max(deltaT), min(deltaT)</li>
<li>mean(deltaS), max(deltaS), min(deltaS)</li>
</ul>
<ol start="4" style="list-style-type: upper-alpha">
<li>To fail the test, require that:</li>
</ol>
<ul>
<li>max(deltaT) &lt; 0.3 ºC</li>
<li>min(deltaT) &lt; 0.001 ºC</li>
<li>mean(deltaT) &lt; 0.02 ºC</li>
<li>max(deltaS) &lt; 0.3 PSU</li>
<li>min(deltaS) &lt; 0.001 PSU</li>
<li>mean(deltaS) &lt; 0.004 PSU</li>
</ul>
<p>If a profile fails this test, all measurements from this profile are flagged as bad data (‘4’). If a float fails this test over 5 consecutive cycles, it is inserted in the grey list.</p>
<ol start="19" style="list-style-type: decimal">
<li><strong>Deepest pressure test</strong></li>
</ol>
<p>This test requires that a profile has pressures that are not greater than <code>CONFIG_ProfilePressure_dbar</code> plus 10%. The value of <code>CONFIG_ProfilePressure_dbar</code> is in the meta.nc file of the float.</p>
<p>If there is a region of incorrect pressures, those pressures and their corresponding temperature and salinity measurements are flagged as bad data (‘4’). Pressures flagged as bad data and their associated measurements should be removed from distribution.</p>
<ol start="25" style="list-style-type: decimal">
<li><strong>MEDian with a distance (MEDD) test</strong> (CTD)</li>
</ol>
<p>This test is a set of algorithms based on three main steps:</p>
<ul>
<li>First, the computation of a sliding median with some customizations</li>
<li>Then, limits are computed that are at relative 2-dimension distance d from the median</li>
<li>Finally, these limits are also computed for the density profile. There is a spike if both the density profile measurement profile are out of limits. If there is no conductivity sensor, then the spikes in temperature are evaluated using a bigger d value.</li>
</ul>
<p>Temperature and salinity values that fail this test are flagged as bad data (‘4’).</p>
<ol start="56" style="list-style-type: decimal">
<li><strong>pH-specific real-time QC test</strong> (PH_IN_SITU_TOTAL only)</li>
</ol>
<p>Currently, there is no pH-specific QC test. If one is established, it will be reported with the number ‘56’.</p>
<p>Real-time pH values which pass the real-time QC tests are assigned QC flags of ‘3’. The Argo goals for research-quality data require that pH values be adjusted to receive a quality flag of ‘1’.</p>
<ol start="57" style="list-style-type: decimal">
<li><strong>DOXY-specific real-time QC test</strong> (DOXY only)</li>
</ol>
<p>Real-time unadjusted <code>DOXY</code>values receive QC flags of ‘3’. This is because the majority of oxygen sensors deployed on BGC Argo profiling floats are Aanderaa optodes that suffer from pre-deployment storage drift that can reduce accuracy by up to 20% or more. Because this is a known bias that affects the majority of oxygen sensors within the array, and because it can be corrected, <code>DOXY_QC</code> is set to ‘3’.</p>
<ol start="59" style="list-style-type: decimal">
<li><strong>Nitrate-specific real-time QC test</strong> (NITRATE only)</li>
</ol>
<p><em>Not yet available</em></p>
</div>
<div id="test-application-order-on-vertical-profiles" class="section level4">
<h4>Test application order on vertical profiles</h4>
<p>The Argo real-time QC tests on CTD data (temperature, salinity, pressure) are performed in the order described in the following table.</p>
<p>A CTD measurement with a QC flag ‘4’ is ignored by other QC tests. A measurement with QC flag ‘2’ or ‘3’ is tested by other QC tests.</p>
<p>A <code>DOXY</code> measurement with a QC flag ‘4’ or ‘3’ is ignored by other QC tests.</p>
<p>Note that the Test Number is different from the Application Order. The Test Number (n) is a number assigned permanently to each QC test. It is used to fill <code>HISTORY_QCTEST</code> in the Argo profile files. Therefore, each Test Number is uniquely associated to a QC test, and is never replaced, changed, or duplicated.</p>
<p>Each real-time QC test has a unique Binary ID (2<sup>n</sup>) of the unique Test Number (n) is used to record QC tests performed and failed in the variable <code>HISTORY_QCTEST</code>.</p>
<p>The QC flag assigned by a test cannot override a higher value assigned by a previous QC test.</p>
<p>e.g.: a QC flag ‘4’ (bad data) set by the Grey List Test cannot be decreased to QC flag ‘3’ (bad data that are potentially correctable) set by the Gross Salinity or Temperature Sensor Drift Test.</p>
<table>
<colgroup>
<col width="31%" />
<col width="13%" />
<col width="14%" />
<col width="40%" />
</colgroup>
<thead>
<tr class="header">
<th>Application Order for CTD parameters</th>
<th>Test Number (n)</th>
<th>Binary ID (2<sup>n</sup>)</th>
<th>Test Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>2</td>
<td>Platform Identification Test</td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
<td>4</td>
<td>Impossible Date Test</td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
<td>8</td>
<td>Impossible Location Test</td>
</tr>
<tr class="even">
<td>4</td>
<td>4</td>
<td>16</td>
<td>Position on Land Test</td>
</tr>
<tr class="odd">
<td>5</td>
<td>5</td>
<td>32</td>
<td>Impossible Speed Test</td>
</tr>
<tr class="even">
<td>6</td>
<td>15</td>
<td>32768</td>
<td>Grey List Test</td>
</tr>
<tr class="odd">
<td>7</td>
<td>19</td>
<td>524288</td>
<td>Deepest Pressure Test</td>
</tr>
<tr class="even">
<td>8</td>
<td>6</td>
<td>64</td>
<td>Global Range Test</td>
</tr>
<tr class="odd">
<td>9</td>
<td>7</td>
<td>128</td>
<td>Regional Range Test</td>
</tr>
<tr class="even">
<td>10</td>
<td>8</td>
<td>256</td>
<td>Pressure Increasing Test</td>
</tr>
<tr class="odd">
<td>11</td>
<td>9</td>
<td>512</td>
<td>Spike Test</td>
</tr>
<tr class="even">
<td>12</td>
<td>25</td>
<td>33554432</td>
<td>MEDD Test</td>
</tr>
<tr class="odd">
<td>13</td>
<td>12</td>
<td>4096</td>
<td>Digit Rollover Test</td>
</tr>
<tr class="even">
<td>14</td>
<td>13</td>
<td>8192</td>
<td>Stuck Value Test</td>
</tr>
<tr class="odd">
<td>15</td>
<td>14</td>
<td>16384</td>
<td>Density Inversion Test</td>
</tr>
<tr class="even">
<td>16</td>
<td>16</td>
<td>65536</td>
<td>Gross Salinity or Temperature Sensor Drift Test</td>
</tr>
<tr class="odd">
<td>17</td>
<td>18</td>
<td>261144</td>
<td>Frozen Profile Test</td>
</tr>
<tr class="even">
<td><em>18</em></td>
<td><em>17</em></td>
<td>131072</td>
<td><em>Visual QC Test</em></td>
</tr>
</tbody>
</table>
<p>The real-time tests for BGC parameters are performed in the order described in the following table:</p>
<table>
<colgroup>
<col width="28%" />
<col width="12%" />
<col width="13%" />
<col width="45%" />
</colgroup>
<thead>
<tr class="header">
<th>Application order for BGC parameters</th>
<th>Test Number (n)</th>
<th>Binary ID (2<sup>n</sup>)</th>
<th>Test Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>19</td>
<td>524288</td>
<td>Deepest Pressure Test</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>2</td>
<td>Platform Identification Test</td>
</tr>
<tr class="odd">
<td>3</td>
<td>2</td>
<td>4</td>
<td>Impossible Date Test</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>8</td>
<td>Impossible Location Test</td>
</tr>
<tr class="odd">
<td>5</td>
<td>4</td>
<td>16</td>
<td>Position on Land Test</td>
</tr>
<tr class="even">
<td>6</td>
<td>5</td>
<td>32</td>
<td>Impossible Speed Test</td>
</tr>
<tr class="odd">
<td>7</td>
<td>6</td>
<td>64</td>
<td>Global Range Test</td>
</tr>
<tr class="even">
<td>8</td>
<td>7</td>
<td>128</td>
<td>Regional Range Test</td>
</tr>
<tr class="odd">
<td>9</td>
<td>9</td>
<td>512</td>
<td>Spike Test</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>2048</td>
<td>Gradient Test</td>
</tr>
<tr class="odd">
<td>11</td>
<td>12</td>
<td>4096</td>
<td>Digit Rollover Test</td>
</tr>
<tr class="even">
<td>12</td>
<td>13</td>
<td>8192</td>
<td>Stuck Value Test</td>
</tr>
<tr class="odd">
<td>13</td>
<td>15</td>
<td>32768</td>
<td>Grey List Test</td>
</tr>
<tr class="even">
<td><em>14</em></td>
<td><em>16</em></td>
<td><em>65536</em></td>
<td><em>Gross Temperature Sensor Drift Test (only for TEMP_DOXY)</em></td>
</tr>
<tr class="odd">
<td>15</td>
<td>18</td>
<td>261144</td>
<td>Frozen Profile Test</td>
</tr>
<tr class="even">
<td>16</td>
<td></td>
<td></td>
<td>BGC parameter-specific tests</td>
</tr>
<tr class="odd">
<td><em>17</em></td>
<td><em>17</em></td>
<td><em>131072</em></td>
<td><em>Visual QC Test</em></td>
</tr>
</tbody>
</table>
</div>
<div id="delayed-mode-quality-control" class="section level4">
<h4>Delayed-Mode Quality Control</h4>
<p>The QC flags determined in delayed-mode replace those assigned in real-time because some bad data cannot be detected by the real-time tests, and some good data can be identified wrongly as bad by the real-time tests.</p>
<p>For vertical profile data, delayed-mode operators examine them for pointwise errors (such as spikes and jumps) and flag them appropriately. If an error is identified, both <code>PARAM_QC</code> and <code>PARAM_ADJUSTED_QC</code> record ‘4’. Conversely, if good data have wrongly been identified as bad by the real-time tests, then <code>PARAM_QC</code> and <code>PARAM_ADJUSTED_QC</code> record ‘1’.</p>
<p>In SD-files, the variables <code>PROFILE_PARAMETER_QC</code>, <code>PARAMETER_ADJUSTED</code>, <code>PARAMETER_ADJUSTED_QC</code>, and <code>PARAMETER_ADJUSTED_ERROR</code> are compulsory. If no adjustment in delayed-mode is necessary and if the flag is deemed assigned correctly, then <code>PARAM_ADJUSTED = PARAMETER</code>, <code>PARAM_ADJUSTED_QC = PARAM_QC</code>, and <code>PARAM_ADJUSTED_ERROR</code> is provided by the PI.</p>
<p>If no delayed-mode adjustment was performed, then <code>PARAM_ADJUSTED = 99999.f</code>, <code>PARAM_ADJUSTED_QC = " "</code>, <code>PARAM_ADJUSTED_ERROR = 99999.f</code> and <code>PROFILE_PARAMETER_QC = " "</code>.</p>
<p>If values are deemed unadjustable in delayed-mode, then <code>PARAM_ADJUSTED_QC = '4'</code>, and <code>PARAM_ADJUSTED = 99999.f</code> and <code>PARAM_ADJUSTED_ERROR = 99999.f</code>.</p>
<p>The variable <code>PROFILE_PARAMETER_QC</code> is recomputed when <code>PARAMETER_ADJUSTED_QC</code> becomes available.</p>
<p><strong>Dates</strong></p>
<p>Delayed-mode operators check that the dates in the profile are in chronological order. Erroneous or missing dates are replaced with another telemetered value if available, or replaced with interpolated values and marked <code>DATE_QC = '8'</code>.</p>
<p><strong>Location</strong></p>
<p>Profile positions <code>LONGITUDE</code>, <code>LATITUDE</code> are checked for outliers. Erroneous or missing dates are replaced with another telemetered value if available, or replaced with interpolated values and marked <code>POSITION_QC = '8'</code>.</p>
<p><strong>Pressure, Temperature, Salinity</strong></p>
<p>Delayed-mode quality control of <code>PRES</code> and <code>TEMP</code> is done by subjective assessment of vertical profile plots of <code>TEMP</code> vs <code>PRES</code> and <code>PSAL</code> vs <code>PRES</code> and <code>PRES</code> vs <code>TEMP</code> and <code>PSAL</code> vs <code>TEMP</code>. This assessment is done in relation to measurements from the same float, as well as in relation to nearby floats and historical data. This assessment aims to identify: (a) erroneous data points that cannot be detected by real-time QC tests, and (b) vertical profiles that have the wrong shape.</p>
<p>Bad <code>PRES</code> data points identified by visual inspection from delayed-mode analysts are recorded with <code>PRES_ADJUSTED_QC = '4'</code> and <code>PRES_QC = '4'</code>. For these bad data points, <code>TEMP_ADJUSTED_QC</code>, <code>TEMP_QC</code>, <code>PSAL_ADJUSTED_QC</code>, and <code>PSAL_QC</code> are also set to ‘4’.</p>
<p>Bad <code>TEMP</code> data points are recorded with <code>TEMP_ADJUSTED_QC = '4'</code> and <code>TEMP_QC = '4'</code>. <code>TEMP_ADJUSTED</code>, <code>TEMP_ADJUSTED_QC</code>, <code>TEMP_ADJUSTED_ERROR</code> are filled even when the data is good and no adjustment is needed. In these cases, <code>TEMP_ADJUSTED_ERROR</code> can be the manufacturer’s quoted accuracy at deployment, which is 0.002 ºC.</p>
<p>Delayed-mode quality control of PSAL is done by checking for sensor offsets and drifts, as well as other instrument errors. Float salinity values that are considered adjustable in delayed-mode are compiled into time-series. Sufficiently long time-series are compared with statistical recommendations and uncertainties to check for sensor drift and offset.</p>
<p>After assessing all available information, the PI records <code>PSAL_ADJUSTED</code>, <code>PSAL_ADJUSTED_QC</code>, and <code>PSAL_ADJUSTED_ERROR</code>. Salinity data considered bad and unadjustable in delayed-mode are given <code>PSAL_ADJUSTED_QC = '4'</code>, and <code>PSAL_ADJUSTED</code> and <code>PSAL_ADJUSTED_ERROR</code> are set to FillValue.</p>
<p><strong>Oxygen</strong></p>
<p>Raw <code>DOXY</code> values are adjusted in delayed-mode to account for sensor drift and bias. The errors associated with this calibration are recorded in <code>DOXY_ADJUSTED_ERROR</code> in µmol kg<sup>-1</sup>.</p>
<p>When <code>DOXY</code> for the whole profile is bad and cannot be adjusted, then <code>DOXY_ADJUSTED = 99999.f</code>, <code>DOXY_ADJUSTED_ERROR = 99999.f</code>, and <code>DOXY_ADJUSTED_QC = '4'</code>. The calibration information is recorded as <code>SCIENTIFIC_CALIB_EQUATION = 'none'</code>, <code>SCIENTIFIC_CALIB_EQUATION = 'none'</code>, and <code>SCIENTIFIC_CALIB_COMMENT = 'Bad data; not adjustable'</code>.</p>
<p><strong>pH</strong></p>
<p>The pH adjustment process depends on having an accurate model for pH below 1000 m, where temporal and spatial variability is minimal. pH values are adjusted using Multiple Linear Regression (MLR) methods, Linearly Interpolated Regression equations, and a neural network prediction system known as CANYON. The expected error in float pH measurements is derived from the uncertainty in the reference data as well as sensor uncertainties.</p>
<p>The empirical algorithms used in the adjustment process for pH are:</p>
<p>the MLR method of Williams et al. (2016)</p>
<p>the LIR method of Carter et al. (2018)</p>
<p>the CANYON method of Sauzede et al. (2017)</p>
<p>The method used for adjustment is recorded in <code>SCIENTIFIC_CALIB_EQUATION</code>, <code>SCIENTIFIC_CALIB_COEFFICIENT</code>, and <code>SCIENTIFIC_CALIB_COMMENT</code></p>
<p><strong>Quality control manuals</strong></p>
<p><em>CTD data quality control: <a href="https://archimer.ifremer.fr/doc/00228/33951/32470.pdf" class="uri">https://archimer.ifremer.fr/doc/00228/33951/32470.pdf</a> (<a href="http://dx.doi.org/10.13155/33951" class="uri">http://dx.doi.org/10.13155/33951</a></em><strong>)</strong></p>
<p><em>Oxygen data quality control: <a href="https://archimer.ifremer.fr/doc/00354/46542/82301.pdf" class="uri">https://archimer.ifremer.fr/doc/00354/46542/82301.pdf</a> (<a href="http://dx.doi.org/10.13155/46542" class="uri">http://dx.doi.org/10.13155/46542</a></em>)</p>
<p><em>pH data quality control: <a href="https://archimer.ifremer.fr/doc/00460/57195/61336.pdf" class="uri">https://archimer.ifremer.fr/doc/00460/57195/61336.pdf</a> (<a href="https://doi.org/10.13155/57195" class="uri">https://doi.org/10.13155/57195</a>)</em></p>
<p><em>BGC data quality control: <a href="https://archimer.ifremer.fr/doc/00298/40879/42267.pdf" class="uri">https://archimer.ifremer.fr/doc/00298/40879/42267.pdf</a> (<a href="http://dx.doi.org/10.13155/40879" class="uri">http://dx.doi.org/10.13155/40879</a>)</em></p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: openSUSE Leap 15.2

Matrix products: default
BLAS:   /usr/local/R-4.0.3/lib64/R/lib/libRblas.so
LAPACK: /usr/local/R-4.0.3/lib64/R/lib/libRlapack.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] oce_1.4-0           testthat_3.0.4      sf_1.0-2           
 [4] gsw_1.0-6           lubridate_1.7.9     argodata_0.0.0.9000
 [7] forcats_0.5.0       stringr_1.4.0       dplyr_1.0.5        
[10] purrr_0.3.4         readr_1.4.0         tidyr_1.1.3        
[13] tibble_3.1.3        ggplot2_3.3.5       tidyverse_1.3.0    
[16] workflowr_1.6.2    

loaded via a namespace (and not attached):
 [1] httr_1.4.2         sass_0.4.0         bit64_4.0.5        vroom_1.5.5       
 [5] jsonlite_1.7.2     modelr_0.1.8       bslib_0.2.5.1      assertthat_0.2.1  
 [9] blob_1.2.1         cellranger_1.1.0   progress_1.2.2     yaml_2.2.1        
[13] pillar_1.6.2       backports_1.1.10   glue_1.4.2         digest_0.6.27     
[17] promises_1.2.0.1   rvest_0.3.6        colorspace_2.0-2   htmltools_0.5.1.1 
[21] httpuv_1.6.2       pkgconfig_2.0.3    broom_0.7.9        haven_2.3.1       
[25] scales_1.1.1       whisker_0.4        later_1.3.0        tzdb_0.1.2        
[29] git2r_0.27.1       proxy_0.4-26       generics_0.1.0     ellipsis_0.3.2    
[33] withr_2.4.2        cli_3.0.1          magrittr_2.0.1     crayon_1.4.1      
[37] readxl_1.3.1       evaluate_0.14      fs_1.5.0           fansi_0.5.0       
[41] xml2_1.3.2         class_7.3-17       prettyunits_1.1.1  tools_4.0.3       
[45] hms_0.5.3          lifecycle_1.0.0    munsell_0.5.0      reprex_0.3.0      
[49] compiler_4.0.3     jquerylib_0.1.4    e1071_1.7-8        RNetCDF_2.4-2     
[53] rlang_0.4.11       classInt_0.4-3     units_0.7-2        grid_4.0.3        
[57] rstudioapi_0.13    rmarkdown_2.10     gtable_0.3.0       DBI_1.1.1         
[61] R6_2.5.1           knitr_1.33         bit_4.0.4          utf8_1.2.2        
[65] rprojroot_2.0.2    KernSmooth_2.23-17 stringi_1.5.3      parallel_4.0.3    
[69] Rcpp_1.0.7         vctrs_0.3.8        dbplyr_1.4.4       tidyselect_1.1.0  
[73] xfun_0.25         </code></pre>
</div>
</div>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
